<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>web-jx</title>
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/index.css">
    <script type="text/javascript" src="lib/jquery-3.5.1.min.js"></script>
</head>

<body>
    <div class="shortcut">
        <div class="w">
            <ul class="fl">
                <li class="dropDownButton">送至：北京
                    <i class="bottomArrow">﹀</i>
                    <div class="dropDownContent">
                        <div class="item"><a>北京</a></div>
                        <div class="item"><a>上海</a></div>
                        <div class="item"><a>天津</a></div>
                        <div class="item"><a>重庆</a></div>
                        <div class="item"><a>河北</a></div>
                        <div class="item"><a>黑龙江</a></div>
                        <div class="item"><a>山西</a></div>
                        <div class="item"><a>河南</a></div>
                        <div class="item"><a>辽宁</a></div>
                        <div class="item"><a>吉林</a></div>
                        <div class="item"><a>内蒙古</a></div>
                        <div class="item"><a>江苏</a></div>
                        <div class="item"><a>安徽</a></div>
                        <div class="item"><a>山东</a></div>
                        <div class="item"><a>浙江</a></div>
                        <div class="item"><a>福建</a></div>
                        <div class="item"><a>湖北</a></div>
                        <div class="item"><a>湖南</a></div>
                        <div class="item"><a>广东</a></div>
                        <div class="item"><a>广西</a></div>
                        <div class="item"><a>江西</a></div>
                        <div class="item"><a>四川</a></div>
                        <div class="item"><a>海南</a></div>
                        <div class="item"><a>贵州</a></div>
                        <div class="item"><a>云南</a></div>
                        <div class="item"><a>西藏</a></div>
                        <div class="item"><a>陕西</a></div>
                        <div class="item"><a>甘肃</a></div>
                        <div class="item"><a>青海</a></div>
                        <div class="item"><a>宁夏</a></div>
                        <div class="item"><a>新疆</a></div>
                        <div class="item"><a>港澳</a></div>
                        <div class="item"><a>钓鱼岛</a></div>
                        <div class="item"><a>台湾</a></div>
                        <div class="item"><a>海外</a></div>
                    </div>
                </li>
            </ul>
            <ul class="fr">
                <li class="dt"><a class href="javascript:void(0);">你好，请登录</a></li>
                <li class="dt"><a class="col-red" href="javascript:void(0);">免费注册</a></li>
                <li class="dt"><a class href="javascript:void(0);">我的订单</a></li>
                <li class="seperator"></li>
                <li class="dropDownButton dt">我的京西
                    <i class="bottomArrow">﹀</i>
                    <div class="dropDownContent">
                        <div>
                            <div class="item-long"><a>待处理订单</a></div>
                            <div class="item-long"><a>消息</a></div>
                            <div class="item-long"><a>返修退换货</a></div>
                            <div class="item-long"><a>我的问答</a></div>
                            <div class="item-long"><a>降价商品</a></div>
                            <div class="item-long"><a>我的关注</a></div>
                            <div class="item-long"><a>我的京豆</a></div>
                            <div class="item-long"><a>我的优惠券</a></div>
                            <div class="item-long"><a>我的白条</a></div>
                            <div class="item-long"><a>我的理财</a></div>
                        </div>
                    </div>
                </li>
                <li class="seperator"></li>
                <li class="dropDownButton col-red dt">企业采购
                    <span class="bottomArrow">﹀</span>
                    <div class="dropDownContent">
                        <div class="item-long"><a>企业购</a></div>
                        <div class="item-long"><a>商用场景馆</a></div>
                        <div class="item-long"><a>工业品</a></div>
                        <div class="item-long"><a>丰客多商城</a></div>
                        <div class="item-long"><a>礼品卡</a></div>
                        <div class="item-long"><a>微信企业购</a></div>
                    </div>
                </li>
                <li class="seperator"></li>
                <li class="dropDownButton dt">客户服务
                    <i class="bottomArrow">﹀</i>
                    <div class="dropDownContent">
                        <div><span>客户</span></div>
                        <div>
                            <div class="item-long"><a>帮助中心</a></div>
                            <div class="item-long"><a>售后服务</a></div>
                            <div class="item-long"><a>在线客服</a></div>
                            <div class="item-long"><a>意见建议</a></div>
                            <div class="item-long"><a>电话客服</a></div>
                            <div class="item-long"><a>客服邮箱</a></div>
                            <div class="item-long"><a>金融咨询</a></div>
                            <div class="item-long"><a>全球售客服</a></div>
                            <div class="item-long"><a>企业客服</a></div>
                        </div>
                        <div><span>商户</span></div>
                        <div>
                            <div class="item-long"><a>合作招商</a></div>
                            <div class="item-long"><a>成长中心</a></div>
                            <div class="item-long"><a>商家后台</a></div>
                            <div class="item-long"><a>京麦工作台</a></div>
                            <div class="item-long"><a>商家帮助</a></div>
                            <div class="item-long"><a>规则平台</a></div>
                        </div>
                    </div>
                </li>
                <li class="seperator"></li>
                <li class="dropDownButton dt">网站导航
                    <i class="bottomArrow">﹀</i>
                    <div class="dropDownContent ">
                        <div><span>更多精选</span></div>
                        <div>
                            <div class="item-long"><a>合作招商</a></div>
                            <div class="item-long"><a>京西通信</a></div>
                            <div class="item-long"><a>京西E卡</a></div>
                            <div class="item-long"><a>企业采购</a></div>
                            <div class="item-long"><a>服务市场</a></div>
                            <div class="item-long"><a>办公生活馆</a></div>
                            <div class="item-long"><a>校园加盟</a></div>
                            <div class="item-long"><a>京西社区</a></div>
                            <div class="item-long"><a>游戏社区</a></div>
                            <div class="item-long"><a>知识产权维权</a></div>
                        </div>
                    </div>
                </li>
                <li class="seperator"></li>
                <li><a class href="javascript:void(0);">手机京西</a></li>
            </ul>
        </div>
    </div>
    <nav>
        <div class="w">
            <ul class="classicfication fl">
                <li><a>家用电器</a></li>
                <li><a>手机</a> / <a>运营商</a> / <a>数码</a></li>
                <li><a>电脑</a> / <a>办公</a></li>
                <li><a>家居</a> / <a>家具</a> / <a>家装</a> / <a>厨具</a></li>
                <li><a>男装</a> / <a>女装</a> / <a>童装</a> / <a>内衣</a></li>
                <li><a>美妆</a> / <a>个护清洁</a> / <a>宠物</li>
                <li><a>女鞋</a> / <a>箱包</a> / <a>钟表</a> / <a>珠宝</a></li>
                <li><a>男鞋</a> / <a>运动</a> / <a>户外</a></li>
                <li><a>房产</a> / <a>汽车</a> / <a>汽车用品</a></li>
                <li><a>母婴</a> / <a>玩具乐器</a></li>
                <li><a>食品</a> / <a>酒类</a> / <a>生鲜</a> / <a>特产</a></li>
                <li><a>艺术</a> / <a>礼品鲜花</a> / <a>农资绿植</a></li>
                <li><a>医药</a> / <a>保健</a> / <a>计生情趣</a></li>
                <li><a>图书</a> / <a>文娱</a> / <a>教育/<a>电子书</li>
                <li><a>机票</a> / <a>酒店</a> / <a>旅游</a> / <a>生活</a></li>
                <li><a>理财</a> / <a>众筹</a> / <a>白条</a> / <a>保险</a></li>
                <li><a>安装</a> / <a>维修</a> / <a>清洗</a> / <a>二手</a></li>
                <li><a>工业品</a></li>
            </ul>
            <div class="carousel fl">
                <ul>
                    <li class="show"><img src="images/carousel_center/1.jpg"/></li>
                    <li><img src="images/carousel_center/2.jpg"/></li>
                    <li><img src="images/carousel_center/3.jpg"/></li>
                    <li><img src="images/carousel_center/4.jpg"/></li>
                    <li><img src="images/carousel_center/5.jpg"/></li>
                </ul>
                <ol class="index">
                    <li class="current">1</li>
                    <li>2</li>
                    <li>3</li>
                    <li>4</li>
                    <li>5</li>
                </ol>
            </div>
            <div class="carousel_right fl">
                <ul>
                    <li><img/></li>
                    <li><img/></li>
                    <li><img/></li>
                </ul>
                <button class="button_left"><span><</span></button>
                <button class="button_right"><span>></span></button>
            </div>
            <div class="other fl">
                <div class="vip">
                    <div>
                        <div class="head_img fl"></div>
                        <div class="login fl">
                            <div><a>Hi~欢迎逛京西!</a></div>
                            <div><a>登录</a> | <a>注册</a></div>
                        </div>
                    </div>
                    <div class="buttons">
                        <button class="button_left"><span>新人福利</span></button>
                        <button class="button_right"><span>超级VIP</span></button>
                    </div>
                </div>
            </div>
        </div>
    </nav>
    <script>
        function randomColor(min = 0, max = 255) {
            min = Math.max(0, min);
            max = Math.min(255, max);
            let random = () => {
                return parseInt(Math.random() * (max - min) + min);
            }
            return 'rgb(' + random() + ',' + random() + ',' + random() + ')';
        }

        function getOffsetLeft(element, end = { endKey : 'tagName', endName : 'BODY' }) {
            let endKey = end.endKey, endName = end.endName;
            let recursion = (element) => {
                if (element !== null && element[endKey] !== endName) {
                    return element.offsetLeft + recursion(element.parentNode);
                } else return 0;
            }

            return recursion(element);
        }

        function adjustDropDownContentPostion(content) {
            let w = $('.w')[0];
            let contentWidth = content.offsetWidth;
            let $content = $(content);
            let button = $content.parent('.dropDownButton')[0];
            let buttonLeft = button.offsetLeft;
            console.log(buttonLeft, contentWidth, w.offsetWidth);
            if ((buttonLeft + contentWidth) > (w.offsetWidth)) {
                $content.css('left', button.offsetLeft - contentWidth + button.offsetWidth 
                    + -parseInt($content.css('margin-left')) + 'px');
            }
        }

        $(document).ready(() => {
            //快捷栏事件绑定
            let dropDownButtons = document.getElementsByClassName('dropDownButton');
            for (let button of dropDownButtons) {
                $(button).on('mouseenter', () => {
                    let content = $(button).children('.dropDownContent');
                    content.css('display', 'block');
                    adjustDropDownContentPostion(content[0]);
                });
                $(button).on('mouseleave', () => {
                    $(button).children('.dropDownContent').css('display', 'none');
                });
            }
            //绑定[送至]快捷按钮事件
            $(dropDownButtons[0]).find('.item a').on('click', function() {
                dropDownButtons[0].firstChild.textContent = '送至：' + this.textContent;
            });

            //导航事件绑定
            let navigation = document.getElementsByClassName('nav')[0];

            //中间轮播图事件绑定
            let playing = false;
            let currentIndex = 0;
            let autoPlayTimer = 0;
            let carousel = $('nav div.carousel');
            let images = carousel.children('ul:first');
            let indices = carousel.children('ol.index');
            let move = function(index) {
                images.children().removeClass('show');
                images.children().eq(index).addClass('show');
                indices.children().removeClass('current');
                indices.children().eq(index).addClass('current');
            }
            let startPlay = function() {
                if (!playing) {
                    playing = true;
                    autoPlayTimer = setInterval(() => move(++currentIndex % 5), 1800);
                }
            }
            let stopPlay = function() {
                if (playing) {
                    playing = false;
                    clearInterval(autoPlayTimer);
                }
            }
            indices.children().on('mouseover', function() {
                stopPlay();
                let src = $(this);
                currentIndex = src.index();
                move(currentIndex);
            });
            //移出时重启自动播放
            indices.on('mouseleave', () => {
                startPlay();
            });
            startPlay();

            //右侧轮播图事件绑定
            let carousel_right = $('nav div.carousel_right');
            let buttons = carousel_right.children('button');
            carousel_right.on('mouseover', () => {
                buttons.removeClass('hide');
                buttons.addClass('show');
            });
            carousel_right.on('mouseout', () => {
                buttons.removeClass('show');
                buttons.addClass('hide');
            });
            let random_carousel = function() {
                let images = carousel_right.find('img');
                let list = carousel_right.find('li');
                list.each(function() {
                    $(this).css('background-color', randomColor(128, 255));
                })
                images.each(function() {
                    $(this).attr('src', 'images/carousel_right/' + Math.floor(Math.random() * 9) + '.webp');
                }); 
            }
            buttons.on('click', () => random_carousel());
            //自动轮换
            let rightCarouselTimer = setInterval(() => {
                random_carousel();
            }, 8000);
            //启动第一次
            random_carousel();
        });
    </script>
</body>

</html>